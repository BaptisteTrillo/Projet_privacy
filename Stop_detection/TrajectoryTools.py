var WSB;(function(n){var t;(function(t){var i;(function(i){function l(){var n;if((n=e())!==null&&n!==void 0)return n.isDarkMode}function a(){var n;return((n=e())===null||n===void 0?void 0:n.errorBoundaryResetKey)||0}function r(){const{mainPageState:n}=o();return n.mainPageData}function v(){const{mainPageState:n}=o();return n.mainPageLayout}function y(){var n;if((n=r())!==null&&n!==void 0)return n.dynamicAnswer}function h(n){var t;const i=(t=r())===null||t===void 0?void 0:t.feedAnswers;return i?React.useMemo(()=>i.filter(t=>t.answerPlacement==n),[i,n]):[]}function s(){return h("Default")}function p(){return h("Hero")}function w(){var n;if((n=r())!==null&&n!==void 0)return n.learningAnswer}function b(){var n;if((n=r())!==null&&n!==void 0)return n.popularSearchesAnswer}function k(){const n=s();return n.find(n=>n.answerPlacement=="Hero")}function d(){var n;if((n=r())!==null&&n!==void 0)return n.acronymsAnswer}function g(){var n;if((n=r())!==null&&n!==void 0)return n.dynamicAnswerState}function nt(){var n;if((n=r())!==null&&n!==void 0)return n.eduAssignmentAnswer}function tt(){var n;if((n=r())!==null&&n!==void 0)return n.eduClassAnswer}function it(n){var t,i,r;switch(n){case"MyOrgChart":return(t=e())===null||t===void 0?void 0:t.isMyOrgChartExpanded;case"EduClasses":return(i=e())===null||i===void 0?void 0:i.isEduClassesExpanded;case"EduAssignments":return(r=e())===null||r===void 0?void 0:r.isEduAssignmentsExpanded}}function c(){var n,i;return(i=(n=e())===null||n===void 0?void 0:n.blendMode)!==null&&i!==void 0?i:t.DEFAULT_BLEND_MODE}function rt(){var n;if((n=r())!==null&&n!==void 0)return n.eduCardAnswer}function ut(){var n;if((n=r())!==null&&n!==void 0)return n.recommendedPeopleAnswer}function ft(){var n;if((n=r())!==null&&n!==void 0)return n.myOrgChart}function et(){var n;if((n=oi())!==null&&n!==void 0)return n.recommendedPeoplePaginationSetting}function ot(){return n.msbDsbHost.isConsumerContentEnabled()}function st(){const n=u();return React.useCallback((i,r)=>n(t.DataContext.setWsbRequeryAction(i,r)),[])}function ht(n){const i=u();return React.useCallback(r=>{switch(n){case"MyOrgChart":i(t.DataContext.setMyOrgChartExpansionAction(r));break;case"EduClasses":i(t.DataContext.setEduClassesExpansionAction(r));break;case"EduAssignments":i(t.DataContext.setEduAssignmentsExpansionAction(r))}},[])}function ct(){const n=u();return React.useCallback((i,r,u)=>{n(t.DataContext.dismissAnswerAction(i,r,u))},[])}function lt(){const n=u();return React.useCallback((i,r)=>{n(t.DataContext.hideAnswerAction(i,r))},[])}function at(){const n=u();return React.useCallback(i=>{n(t.DataContext.launchUriAction(i))},[])}function vt(){const n=u();return React.useCallback(i=>{n(t.DataContext.launchProactiveWorkSearch(i))},[])}function yt(){const n=u();return React.useCallback(()=>{n(t.DataContext.forceDSBRefreshAction())},[])}function pt(){const n=u();return React.useCallback((i,r)=>{n(t.DataContext.navigatePageAction(i,r))},[])}function wt(){const n=u();return React.useCallback(i=>{n(t.DataContext.setLastSelectedScopeAction(i))},[])}function bt(){const{state:{imageOfTheDay:i},dispatch:r}=f(),n=i.imageOfTheDay;return React.useEffect(()=>{n===undefined&&r(t.DataContext.fetchImageOfTheDayAction())},[n]),n}function kt(n){const{state:{personPhotos:r},dispatch:u}=f();if(!n)return null;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchPersonPhotoAction(n))},[i]),(i===null||i===void 0?void 0:i.imageInBase64)||null}function dt(){const{state:{m365AppsState:i},dispatch:r}=f(),n=i.appStateList;return React.useEffect(()=>{n===undefined&&r(t.DataContext.fetchM365AppStateAction())},[n]),n||null}function gt(n){const{state:{groupPhotos:r},dispatch:u}=f();if(!n)return null;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchGroupPhotoAction(n))},[i]),i===null||i===void 0?void 0:i.imageInBase64}function ni(n,i="Medium"){const{itemId:u}=n;if(!u)return null;const{state:{feedItemPreviews:e},dispatch:o}=f(),r=e[u];return React.useEffect(()=>{r===undefined&&o(t.DataContext.fetchFeedItemPreviewAction(n,i))},[r]),(r===null||r===void 0?void 0:r.imageInBase64)||null}function ti(n){const{state:{fileIcons:r},dispatch:u}=f();if(!n)return t.DEFAULT_FILE_ICON;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchFileIconAction(n))},[i]),i||t.DEFAULT_FILE_ICON}function ii(n){const{state:{fluentIconSvgHtmls:r},dispatch:u}=f();if(!n)return null;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchFluentIconSvgHtmlAction(n))},[i]),i}function ri(){const{chatUpsellState:n}=o();return n}function ui(){const t=c()==="Blended";return n.config.msbDsbHidePeopleSearchBox||t}function fi(){const t=n.msbDsbHost.getLocString("CompanyNamePlaceholder");return n.msbHost.getTenantName()||t}function ei(){const t=s();return n.msbDsbHost.isWideLayoutEnabled()&&t.length>0}function e(){const{uiOptions:n}=o();return n}function oi(){const{paginationSettings:n}=o();return n}function o(){const{state:n}=f();return n}function u(){const{dispatch:n}=f();return n}function f(){return React.useContext(t.DataContext.ViewDataContext)}i.useIsDarkMode=l;i.useErrorBoundaryResetKey=a;i.useMainPageData=r;i.useMainPageLayout=v;i.useDynamicAnswer=y;i.useFeedAnswers=s;i.useHeroAnswers=p;i.useLearningAnswer=w;i.usePopularSearchesAnswer=b;i.useHeroAnswer=k;i.useAcronymsAnswer=d;i.useDynamicAnswerState=g;i.useEduAssignmentAnswer=nt;i.useEduClassAnswer=tt;i.useIsElementExpanded=it;i.useBlendMode=c;i.useEduCardAnswer=rt;i.useRecommendedPeopleAnswer=ut;i.useOrgChartAnswer=ft;i.useRecommendedPeoplePaginationSetting=et;i.useIsConsumerContentEnabled=ot;i.useDispatchSetWsbRequeryAction=st;i.useDispatchSetElementExpansionAction=ht;i.useDispatchDismissAnswerAction=ct;i.useDispatchHideAnswerAction=lt;i.useDispatchLaunchUriAction=at;i.useDispatchLaunchProactiveWorkSearchAction=vt;i.useDispatchForceDsbRefreshAction=yt;i.useDispatchNavigatePageAction=pt;i.useDispatchSetLastSelectedScopeAction=wt;i.useImageOfTheDay=bt;i.usePersonPhotoBase64=kt;i.useM365AppStateList=dt;i.useGroupPhotoBase64=gt;i.useFeedItemPreviewBase64=ni;i.useFileIcon=ti;i.useFluentIconSvgHtml=ii;i.useChatUpsell=ri;i.useShouldHideSearchBox=ui;i.useTenantDisplayName=fi;i.useShouldShowWideLayout=ei})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))})(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){i.MainPageTemplate=()=>React.createElement(i.MsbDsbErrorBoundary,{fallback:React.createElement(h,null),fallbackInstrumentSectionName:"MainPageErrorBoundaryFallback",wrappedComponentName:"MainPageTemplateWrapper"},React.createElement(f,null));const f=()=>{const t=i.useMainPageData();if(!t)return null;const r=!n.msbDsbHost.isWideLayoutEnabled(),u=!!n.msbHost.isEduTenant();return u?React.createElement(i.EduMainPageTemplateImpl,null):r?React.createElement(o,null):React.createElement(e,null)},e=()=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("MainPage");const f=i.useMainPageData(),r=i.useDynamicAnswerState(),u=i.useShouldShowWideLayout();React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[f]);n.msbDsbHost.setWideModeStyle(!!u);const e=r===null||r===void 0?void 0:r.isAnswerStatusSucceeded;return React.createElement("div",{className:"msbdsb-mp","data-id":t.MAINPAGE_CONTAINER_ID},React.createElement(i.HeaderSection,null),React.createElement("div",{className:"msbdsb-mp-content",id:t.MAINPAGE_CONTAINER_SCROLL},u&&React.createElement(c,null),!u&&(e?React.createElement(l,null):React.createElement(a,null))))},o=()=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("MainPage");const u=i.useMainPageData(),r=i.useMainPageLayout();if(r.length==0)throw new Error("Empty main page layout");return React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[u]),React.createElement("div",{className:"msbdsb-mp","data-id":t.MAINPAGE_CONTAINER_ID},React.createElement(i.HeaderSection,null),React.createElement("div",{className:"msbdsb-mp-content",id:t.MAINPAGE_CONTAINER_SCROLL},r.map(n=>React.createElement(s,{component:n,key:n}))))},s=({component:t})=>{switch(t){case"SearchBox":return i.useShouldHideSearchBox()?null:React.createElement(i.WorkSearchBox,{isIndependent:!0});case"ScopeSwitch":return React.createElement(i.ScopeEntrySection,null);case"M365AppList":return React.createElement(i.M365AppList,null);case"Feed":return React.createElement(i.MicrosoftFeedCard,null);case"FileHero":return React.createElement(i.HeroSection,null);case"RecommendedPeople":return React.createElement(i.RecommendedPeopleSection,null);case"OrgChart":return React.createElement(i.OrgChart,{isIndependent:!0});case"Dynamic":return React.createElement(i.DynamicAnswerCard,null);case"SearchSuggestions":return React.createElement(u,null);case"PopularSearch":return React.createElement(i.PopularTenantSearchesCard,null);case"Acronyms":return React.createElement(i.AcronymsCard,null);case"WorkChatCard":return React.createElement(i.WorkChatCard,{chatEligibility:n.msbHost.getChatEligibility()});default:return null}},h=()=>React.createElement("div",{className:"msbdsb_mainpage_fallback_boundary msbdsb-mp-content"},React.createElement(i.MsbDsbErrorBoundaryDefaultFallback,null)),c=()=>React.createElement(React.Fragment,null,React.createElement("div",{className:"left-col"},React.createElement(i.DynamicAnswerCard,null),React.createElement(i.MicrosoftFeedCard,null)),React.createElement(r,{isOnDsbTop:!1})),l=()=>{const n=i.useDynamicAnswerState();return React.createElement(React.Fragment,null,React.createElement(i.DynamicAnswerCard,null),!(n===null||n===void 0?void 0:n.isAnswerM365Content)&&React.createElement(i.MicrosoftFeedCard,null),React.createElement(r,{isOnDsbTop:!1}))},a=()=>React.createElement(React.Fragment,null,React.createElement(r,{isOnDsbTop:!0}),React.createElement(i.MicrosoftFeedCard,null)),r=({isOnDsbTop:t})=>{const e=i.useShouldShowWideLayout(),o=e?"right-col":"msbdsb_card_background",s=i.useHeroAnswers(),r=n.config.msbDsbFileHero&&s.length>0&&!e&&t,f=i.useShouldHideSearchBox();return React.createElement("div",{className:o},r?React.createElement("div",null,f?null:React.createElement(i.WorkSearchBox,{isIndependent:!0}),React.createElement(i.HeroSection,null)):undefined,n.msbDsbHost.isPeopleExplanationEnabled()?React.createElement(i.SplitPeopleSection,{hidePeopleSearchBox:r||f}):React.createElement(i.PeopleCard,{hideSearchBox:r||f}),React.createElement(u,null))},u=()=>{var t;const r=i.useShouldShowWideLayout(),u=!r,f=r;return React.createElement(React.Fragment,null,((t=n.msbHost.msbWorkChatUtils)===null||t===void 0?void 0:t.validChatEligibilityStateForCard())&&React.createElement(i.WorkChatCard,{chatEligibility:n.msbHost.getChatEligibility()}),u?React.createElement(i.AcronymsCard,null):undefined,f?React.createElement(i.PopularTenantSearchesCard,null):undefined)}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){const e=6,o=4,s="https://www.bing.com/th?id=ODSWG.b012cfe4-e2fc-482a-a28e-2efadac0fdf3",h="https://www.bing.com/th?id=ODSWG.7336a8ee-7373-4f81-8d7e-5b15cf0d4146";i.PeopleCard=({hideSearchBox:t})=>{const r=i.useTenantDisplayName(),u=n.msbDsbHost.getLocString("PeopleCardTitle",r),f=i.useRecommendedPeopleAnswer(),e=i.useOrgChartAnswer();return React.createElement("div",{className:"msbdsb-mp-ppl","data-region":"PeopleSection",role:"group","aria-label":u},!t&&React.createElement(i.WorkSearchBox,null),(f||e)&&React.createElement("div",{className:"msbdsb_people_box_content"},React.createElement(i.RecommendedPeople,null),React.createElement(i.OrgChart,null)))};i.SplitPeopleSection=({hidePeopleSearchBox:n})=>{const t=i.useRecommendedPeopleAnswer();return React.createElement(React.Fragment,null,!n&&React.createElement(i.WorkSearchBox,{isIndependent:!0}),t&&React.createElement(i.RecommendedPeopleSection,null),React.createElement(i.OrgChart,{isIndependent:!0}))};i.WorkSearchBox=({isIndependent:n})=>React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"WorkSearchBox"},React.createElement(c,{isIndependent:n}));const c=({isIndependent:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("WorkSearchBox");const{searchBoxInstrumentedItem:f}=i.useMainPageData(),e=i.useDispatchSetWsbRequeryAction(),o=t=>{var i;if((i=t.target)===null||i===void 0?void 0:i.value){const i=n.msbHost.features.isWorkScopeDsbRedirectEnabled()?n.Scope.Work:n.Scope.People;e(t.target.value,i);t.target.value=""}},s=i.useTenantDisplayName(),u=n.msbHost.features.isWorkScopeDsbRedirectEnabled()?n.msbDsbHost.getLocString("WorkSearchPlaceholder"):n.msbDsbHost.getLocString("PeopleSearchPlaceholder",s);return React.createElement(i.WithInstrumentation,{instrumentedItem:f},React.createElement("div",{className:`msb_dsb_people_search ${!!r&&"msb_dsb_independent_searchbox"}`},React.createElement("input",{id:"msbdsb_people_search_box",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:"msb_dsb_search_box",type:"text","aria-l